########################################################################
# Frequency Reference PVs

record(ai, "$(P)$(R)FPGAClk-Cte") {
  field(DESC, "FPGA Clock from EVG")
  field(EGU, "Hz")
  field(SCAN, "1 second")
  field(PINI, "1")
  field(VAL, "124914500")
  field(INP, "AS-RaMO:TI-EVG:FPGAClk-Cte")
}

record(stringout, "$(P)$(R)IPAddr-Mon"){
  field(DESC, "IPADDR")
  field(VAL, "$(IPADDR)")
}

record(stringout, "$(P)$(R)IPPort-Mon"){
  field(DESC, "IPPORT")
  field(VAL, "$(IPPORT)")
}

########################################################################
# Control and Status Register [0]

record(bo, "$(P)$(R)DevEnbl-Sel") {
  field(DESC, "enable")
  field(MASK, "1")
  field(DTYP, "stream")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(OUT, "@timing.proto evre_ctrl_set($(P),$(R)) $(PORT)")
  field(PINI, YES)
}

record(mbbiDirect, "$(P)$(R)DevEnblRaw") {
  field(ASG, "Reserved")
  field(DESC, "enable status RAW")
  field(NOBT, "1")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_ctrl_enableRAW_intr $(PORT)")
  field(FLNK, "$(P)$(R)DevEnbl-Sts")
}

record(bi, "$(P)$(R)DevEnbl-Sts") {
  field(ASG, "Reserved")
  field(DESC, "enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)DevEnblRaw.B0")
}

record(mbbiDirect, "$(P)$(R)LinkIntlkRaw") {
  field(ASG, "Reserved")
  field(DESC, "link and inhs status")
  field(NOBT, "8")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_ctrl_linkinhs_intr $(PORT)")
  field(FLNK, "$(P)$(R)IntlkStatus-Mon")
}

record(bi, "$(P)$(R)IntlkStatus-Mon") {
  field(ASG, "Reserved")
  field(DESC, "interlock status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)LinkIntlkRaw.B6")
  field(FLNK, "$(P)$(R)IntlkEnbl-Mon")
}

record(bi, "$(P)$(R)IntlkEnbl-Mon") {
  field(ASG, "Reserved")
  field(DESC, "interlock input enable")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)LinkIntlkRaw.B0")
  field(FLNK, "$(P)$(R)LinkStatus-Mon")
}

record(bi, "$(P)$(R)LinkStatus-Mon") {
  field(ASG, "Reserved")
  field(DESC, "fibre link status")
  field(ZNAM, "Unlink")
  field(ONAM, "Link")
  field(INP, "$(P)$(R)LinkIntlkRaw.B7")
}

record(longout, "$(P)$(R)cmd_ctrl_get") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read Ctrl Status reg")
  field(VAL, "0x80") # (0x80 | reg number)
  field(SCAN, "1 second")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_ctrl_get($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_ctrl_set") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to Ctrl Status reg")
  field(VAL, "0x40") # (0x40 | reg number)
}

########################################################################
# RF output register [40]

record(mbbo, "$(P)$(R)RFOut-Sel") {
  field(DESC, "RF out mode")
  field(PINI, "1")
  field(ZRVL, "0")
  field(ZRST, "Dsbl")
  field(ONVL, "1")
  field(ONST, "RF/4")
  field(TWVL, "2")
  field(TWST, "RF/2")
  field(THVL, "3")
  field(THST, "RF")
  field(FRVL, "4")
  field(FRST, "5*RF/4")
  field(FVVL, "5")
  field(FVST, "10*RF/4")
  field(DTYP, "stream")
  field(OUT, "@timing.proto eve_rf_set($(P),$(R)) $(PORT)")
}

record(mbbi, "$(P)$(R)RFOut-Sts") {
  field(ASG, "Reserved")
  field(DESC, "RF out mode status")
  field(ZRVL, "0")
  field(ZRST, "Dsbl")
  field(ONVL, "1")
  field(ONST, "RF/4")
  field(TWVL, "2")
  field(TWST, "RF/2")
  field(THVL, "3")
  field(THST, "RF")
  field(FRVL, "4")
  field(FRST, "5*RF/4")
  field(FVVL, "5")
  field(FVST, "10*RF/4")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto eve_rf_intr $(PORT)")
}

########################################################################
# Timestamp register [51]

record(mbbo, "$(P)$(R)TimestampSrc-Sel"){
  field(DESC, "timestamp signal source")	
  field(ZRST, "IDLE")
  field(ZRVL, "0")
  field(ONST, "DBUS")
  field(ONVL, "1")
  field(TWST, "EVENT")
  field(TWVL, "2")
  field(THST, "INTERNAL")
  field(THVL, "3")
  field(VAL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_tmstmp_set($(P),$(R)) $(PORT)")
}

record(longin, "$(P)$(R)UTC-RB"){
  field(ASG, "Reserved")
  field(DESC, "timestamp UTC field RBV")
  field(EGU, "seconds")
}

record(longin, "$(P)$(R)SubSecond-Mon"){
  field(ASG, "Reserved")
  field(DESC, "timestamp subsecond field RBV")
  field(EGU, "evt_T")
}

record(mbbi, "$(P)$(R)TimestampSrc-Sts"){
  field(ASG, "Reserved")
  field(DESC, "timestamp signal source RBV")	
  field(ZRST, "IDLE")
  field(ZRVL, "0")
  field(ONST, "DBUS")
  field(ONVL, "1")
  field(TWST, "EVENT")
  field(TWVL, "2")
  field(THST, "INTERNAL")
  field(THVL, "3")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_tmstmp_timesrcRBV_intr $(PORT)")
}

record(longout, "$(P)$(R)cmd_tmstmp_get"){
  field(ASG, "Reserved")
  field(DESC, "Command code to read timestamp reg")
  field(VAL, "0xB3")
  field(SCAN, "1 second")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evre_tmstmp_get($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_tmstmp_set"){
  field(ASG, "Reserved")
  field(DESC, "Command code to write to timestamp reg")
  field(VAL, "0x73")
}

########################################################################
# Digital input 0 [53]

record(longout, "$(P)$(R)DIEvent0-SP") {
  field(DESC, "digital input 0 event code")
  field(DRVH, "255")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evgre_diginp_ev_set($(P),$(R),0) $(PORT)")
}

record(bo, "$(P)$(R)DIEnbl0-Sel") {
  field(DESC, "digital input 0 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)DIStateCalc0")
}

record(bo, "$(P)$(R)DIPol0-Sel") {
  field(DESC, "digital input 0 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)DIPolCalc0")
}

record(bo, "$(P)$(R)DILog0-Sel") {
  field(DESC, "dig. input 0 event timestamp enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)DILogCalc0")
}

record(calcout, "$(P)$(R)DIStateCalc0") {
  field(ASG, "Reserved")
  field(DESC, "digital input 0 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl0-Sel.RVAL")
  field(INPB, "$(P)$(R)DIPol0-Sts.VAL")
  field(INPC, "$(P)$(R)DILog0-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),0,DIStateCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI0Calc")
}

record(calcout, "$(P)$(R)DIPolCalc0") {
  field(ASG, "Reserved")
  field(DESC, "digital input 0 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl0-Sts.VAL")
  field(INPB, "$(P)$(R)DIPol0-Sel.RVAL")
  field(INPC, "$(P)$(R)DILog0-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),0,DIPolCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI0Calc")
}

record(calcout, "$(P)$(R)DILogCalc0") {
  field(ASG, "Reserved")
  field(DESC, "digital input 0 set timestamp calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl0-Sts.VAL")
  field(INPB, "$(P)$(R)DIPol0-Sts.VAL")
  field(INPC, "$(P)$(R)DILog0-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),0,DILogCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI0Calc")
}

record(calcout, "$(P)$(R)DI0Calc") {
  field(ASG, "Reserved")
  field(DESC, "dig.inp. 0 download en, pol and time")
  field(INPA, "$(P)$(R)DIEnbl0-Sel.RVAL")
  field(INPB, "$(P)$(R)DIPol0-Sel.RVAL")
  field(INPC, "$(P)$(R)DILog0-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
}

record(mbbiDirect, "$(P)$(R)DI0Raw") {
  field(ASG, "Reserved")
  field(DESC, "DIGINP0 en, pol, and timestamp RBV")
  field(NOBT, "8")
  field(SHFT, "5")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evgre_diginp0_intr $(PORT)")
  field(FLNK, "$(P)$(R)DILog0-Sts")
}

record(bi, "$(P)$(R)DILog0-Sts") {
  field(ASG, "Reserved")
  field(DESC, "digital input 0 timestamping sts")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)DI0Raw.B0")
  field(FLNK, "$(P)$(R)DIPol0-Sts")
}

record(bi, "$(P)$(R)DIPol0-Sts") {
  field(ASG, "Reserved")
  field(DESC, "digital input 0 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)DI0Raw.B1")
  field(FLNK, "$(P)$(R)DIEnbl0-Sts")
}

record(bi, "$(P)$(R)DIEnbl0-Sts") {
  field(ASG, "Reserved")
  field(DESC, "digital input 0 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)DI0Raw.B2")
}

record(longin, "$(P)$(R)DIEvent0-RB") {
  field(ASG, "Reserved")
  field(DESC, "digital input 0 event RBV")
}

record(longout, "$(P)$(R)cmd_diginp_set0") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to DIGINP0")
  field(VAL, "0x75") # (0x40 | reg number=1)
}

record(longout, "$(P)$(R)cmd_diginp_get0") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read DIGINP0")
  field(VAL, "0xB5") # (0x80 | reg number=1)
}

########################################################################
# Digital input 1 [54]

record(longout, "$(P)$(R)DIEvent1-SP") {
  field(DESC, "digital input 1 event code")
  field(DRVH, "255")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evgre_diginp_ev_set($(P),$(R),1) $(PORT)")
}

record(bo, "$(P)$(R)DIEnbl1-Sel") {
  field(DESC, "digital input 1 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)DIStateCalc1")
}

record(bo, "$(P)$(R)DIPol1-Sel") {
  field(DESC, "digital input 1 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)DIPolCalc1")
}

record(bo, "$(P)$(R)DILog1-Sel") {
  field(DESC, "dig. input 1 event timestamp enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)DILogCalc1")
}

record(calcout, "$(P)$(R)DIStateCalc1") {
  field(ASG, "Reserved")
  field(DESC, "digital input 1 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl1-Sel.RVAL")
  field(INPB, "$(P)$(R)DIPol1-Sts.VAL")
  field(INPC, "$(P)$(R)DILog1-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),1,DIStateCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI1Calc")
}

record(calcout, "$(P)$(R)DIPolCalc1") {
  field(ASG, "Reserved")
  field(DESC, "digital input 1 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl1-Sts.VAL")
  field(INPB, "$(P)$(R)DIPol1-Sel.RVAL")
  field(INPC, "$(P)$(R)DILog1-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),1,DIPolCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI1Calc")
}

record(calcout, "$(P)$(R)DILogCalc1") {
  field(ASG, "Reserved")
  field(DESC, "digital input 1 set timestamp calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl1-Sts.VAL")
  field(INPB, "$(P)$(R)DIPol1-Sts.VAL")
  field(INPC, "$(P)$(R)DILog1-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),1,DILogCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI1Calc")
}

record(calcout, "$(P)$(R)DI1Calc") {
  field(ASG, "Reserved")
  field(DESC, "dig.inp. 1 download en, pol and time")
  field(INPA, "$(P)$(R)DIEnbl1-Sel.RVAL")
  field(INPB, "$(P)$(R)DIPol1-Sel.RVAL")
  field(INPC, "$(P)$(R)DILog1-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
}

record(mbbiDirect, "$(P)$(R)DI1Raw") {
  field(ASG, "Reserved")
  field(DESC, "DIGINP1 en, pol, and timestamp RBV")
  field(NOBT, "8")
  field(SHFT, "5")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evgre_diginp1_intr $(PORT)")
  field(FLNK, "$(P)$(R)DILog1-Sts")
}

record(bi, "$(P)$(R)DILog1-Sts") {
  field(ASG, "Reserved")
  field(DESC, "digital input 1 timestamping sts")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)DI1Raw.B0")
  field(FLNK, "$(P)$(R)DIPol1-Sts")
}

record(bi, "$(P)$(R)DIPol1-Sts") {
  field(ASG, "Reserved")
  field(DESC, "digital input 1 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)DI1Raw.B1")
  field(FLNK, "$(P)$(R)DIEnbl1-Sts")
}

record(bi, "$(P)$(R)DIEnbl1-Sts") {
  field(ASG, "Reserved")
  field(DESC, "digital input 1 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)DI1Raw.B2")
}

record(longin, "$(P)$(R)DIEvent1-RB") {
  field(ASG, "Reserved")
  field(DESC, "digital input 1 event RBV")
}

record(longout, "$(P)$(R)cmd_diginp_set1") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to DIGINP1")
  field(VAL, "0x76") # (0x40 | reg number=1)
}

record(longout, "$(P)$(R)cmd_diginp_get1") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read DIGINP1")
  field(VAL, "0xB6") # (0x80 | reg number=1)
}

########################################################################
# Digital input 2 [55]

record(longout, "$(P)$(R)DIEvent2-SP") {
  field(DESC, "digital input 2 event code")
  field(DRVH, "255")
  field(DRVL, "0")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evgre_diginp_ev_set($(P),$(R),2) $(PORT)")
}

record(bo, "$(P)$(R)DIEnbl2-Sel") {
  field(DESC, "digital input 2 enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)DIStateCalc2")
}

record(bo, "$(P)$(R)DIPol2-Sel") {
  field(DESC, "digital input 2 polarity")
  field(MASK, "1")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(FLNK, "$(P)$(R)DIPolCalc2")
}

record(bo, "$(P)$(R)DILog2-Sel") {
  field(DESC, "dig. input 2 event timestamp enable")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(FLNK, "$(P)$(R)DILogCalc2")
}

record(calcout, "$(P)$(R)DIStateCalc2") {
  field(ASG, "Reserved")
  field(DESC, "digital input 2 set enable calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl2-Sel.RVAL")
  field(INPB, "$(P)$(R)DIPol2-Sts.VAL")
  field(INPC, "$(P)$(R)DILog2-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),2,DIStateCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI2Calc")
}

record(calcout, "$(P)$(R)DIPolCalc2") {
  field(ASG, "Reserved")
  field(DESC, "digital input 2 set polarity calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl2-Sts.VAL")
  field(INPB, "$(P)$(R)DIPol2-Sel.RVAL")
  field(INPC, "$(P)$(R)DILog2-Sts.VAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),2,DIPolCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI2Calc")
}

record(calcout, "$(P)$(R)DILogCalc2") {
  field(ASG, "Reserved")
  field(DESC, "digital input 2 set timestamp calc")
  field(DTYP, "stream")
  field(INPA, "$(P)$(R)DIEnbl2-Sts.VAL")
  field(INPB, "$(P)$(R)DIPol2-Sts.VAL")
  field(INPC, "$(P)$(R)DILog2-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
  field(OUT, "@timing.proto evgre_diginp_ept_set($(P),$(R),2,DILogCalc) $(PORT)")
  field(FLNK, "$(P)$(R)DI2Calc")
}

record(calcout, "$(P)$(R)DI2Calc") {
  field(ASG, "Reserved")
  field(DESC, "dig.inp. 2 download en, pol and time")
  field(INPA, "$(P)$(R)DIEnbl2-Sel.RVAL")
  field(INPB, "$(P)$(R)DIPol2-Sel.RVAL")
  field(INPC, "$(P)$(R)DILog2-Sel.RVAL")
  field(CALC, "(A<<7)|(B<<6)|(C<<5)")
}

record(mbbiDirect, "$(P)$(R)DI2Raw") {
  field(ASG, "Reserved")
  field(DESC, "DIGINP2 en, pol, and timestamp RBV")
  field(NOBT, "8")
  field(SHFT, "5")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evgre_diginp2_intr $(PORT)")
  field(FLNK, "$(P)$(R)DILog2-Sts")
}

record(bi, "$(P)$(R)DILog2-Sts") {
  field(ASG, "Reserved")
  field(DESC, "digital input 2 timestamping sts")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)DI2Raw.B0")
  field(FLNK, "$(P)$(R)DIPol2-Sts")
}

record(bi, "$(P)$(R)DIPol2-Sts") {
  field(ASG, "Reserved")
  field(DESC, "digital input 2 polarity status")
  field(ZNAM, "Normal")
  field(ONAM, "Inverse")
  field(INP, "$(P)$(R)DI2Raw.B1")
  field(FLNK, "$(P)$(R)DIEnbl2-Sts")
}

record(bi, "$(P)$(R)DIEnbl2-Sts") {
  field(ASG, "Reserved")
  field(DESC, "digital input 2 enable status")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(INP, "$(P)$(R)DI2Raw.B2")
}

record(longin, "$(P)$(R)DIEvent2-RB") {
  field(ASG, "Reserved")
  field(DESC, "digital input 2 event RBV")
}

record(longout, "$(P)$(R)cmd_diginp_set2") {
  field(ASG, "Reserved")
  field(DESC, "Command code to write to DIGINP2")
  field(VAL, "0x77") # (0x40 | reg number=1)
}

record(longout, "$(P)$(R)cmd_diginp_get2") {
  field(ASG, "Reserved")
  field(DESC, "Command code to read DIGINP2")
  field(VAL, "0xB7") # (0x80 | reg number=1)
}

########################################################################
# Configuration Register [63]

record(longin, "$(P)$(R)Alive-Mon") {
  field(ASG, "Reserved")
  field(DESC, "alive")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_conf_alive_intr $(PORT)")
  field(FLNK, "$(P)$(R)DevStatusCalc")
}

record(mbbi, "$(P)$(R)ClkMode-RB") {
  field(ASG, "Reserved")
  field(DESC, "clock mode status")
  field(NOBT, "6")
  field(ZRVL, "11")
  field(ZRST, "60-62.5 MHz")
  field(ONVL, "16")
  field(ONST, "63-77 MHz/121-135 MHz")
  field(TWVL, "17")
  field(TWST, "77.5-91.5 MHz")
  field(THVL, "18")
  field(THST, "92-106 MHz")
  field(FRVL, "19")
  field(FRST, "106-120.5 MHz")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_conf_clkmode_intr $(PORT)")
}

record(mbbi, "$(P)$(R)DevFun-Sts") {
  field(ASG, "Reserved")
  field(DESC, "function select status")
  field(NOBT, "6")
  field(ZRVL, "16")
  field(ZRST, "FOUT")
  field(ONVL, "17")
  field(ONST, "EVR")
  field(TWVL, "18")
  field(TWST, "EVG")
  field(THVL, "32")
  field(THST, "EVE")
  field(SCAN, "I/O Intr")
  field(DTYP, "stream")
  field(INP, "@timing.proto evre_conf_funsel_intr $(PORT)")
}

record(mbbo, "$(P)$(R)DevFun-Sel") {
  field(DESC, "STD-EVE fixed configuration")
  field(ZRVL, "32")
  field(ZRST, "EVE")
  field(DTYP, "stream")
  field(VAL, "0")
  field(OUT, "@timing.proto evr_conf_funsel_set($(P),$(R)) $(PORT)")
}

record(mbbo, "$(P)$(R)ClkMode-SP"){
  field(DESC, "clock mode")
  field(ZRVL, "11")
  field(ZRST, "11")
  field(ONVL, "16")
  field(ONST, "16")
  field(TWVL, "17")
  field(TWST, "17")
  field(THVL, "18")
  field(THST, "18")
  field(FRVL, "19")
  field(FRST, "19")
  field(VAL, "1")
  field(DTYP, "stream")
  field(OUT, "@timing.proto eve_conf_set($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_conf_get"){
  field(ASG, "Reserved")
  field(DESC, "Configuration reg read command code")
  field(VAL, "0xBF")
  field(DTYP, "stream")
  field(SCAN, "1 second")
  field(OUT, "@timing.proto eve_conf_get($(P),$(R)) $(PORT)")
}

record(longout, "$(P)$(R)cmd_conf_set") {
  field(ASG, "Reserved")
  field(DESC, "Configuration reg write command code")
  field(VAL, "0x7F")
}

########################################################################
# Write all configuration registers
record(bo, "$(P)$(R)Download-Cmd") {
  field(DESC, "download config to hardware")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
}

record(bo, "$(P)$(R)Download-Trig") {
  field(DESC, "download trigger")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  field(DTYP, "stream")
  field(OUT, "@timing.proto eve_download($(P),$(R)) $(PORT)")
}

record(bo, "$(P)$(R)GetRBV") {
  field(DESC, "upload trigger")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
  #field(HIGH, "0.5")
  field(DTYP, "stream")
  field(OUT, "@timing.proto evr_get_rbv($(P),$(R)) $(PORT)")
}

record(calc, "$(P)$(R)DevStatusCalc") {
  field(ASG, "Reserved")
  field(DESC, "device status calc")
  field(INPA, "$(P)$(R)Alive-Mon")
  field(CALC, "A=0?0:1")
  field(FLNK, "$(P)$(R)DevStatus-Mon")
}

record(bi, "$(P)$(R)DevStatus-Mon") {
  field(ASG, "Reserved")
  field(DESC, "device status")
  field(ZNAM, "WAITING")
  field(ONAM, "RUNNING")
  field(INP, "$(P)$(R)DevStatusCalc")
}

record(bi, "$(P)$(R)Network-Mon") {
  field(ASG, "Reserved")
  field(DESC, "network status")
  field(ZNAM, "Disconnected")
  field(ONAM, "Connected")
  field(FLNK, "$(P)$(R)FrmVersionA-Cte")
}

record(bo, "$(P)$(R)Save-Cmd"){
  field(DESC, "manual Save settings command")
  field(MASK, "1")
  field(ZNAM, "Dsbl")
  field(ONAM, "Enbl")
}
